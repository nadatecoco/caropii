# 🚀 caropii開発ロードマップ（実装順序）
日時：2025-08-17  
作成者：natatekoko + Claude

---

## 📌 このドキュメントの目的

**新しいClaude Codeセッションを開始した時、このファイルを読めば何をどの順番で作るべきかが分かる**

---

## 🎯 最終ゴール

### サロン発表時に「完璧に見えるアプリ」
- クリプトニンジャキャラクター × 健康AIアプリ
- 「広告うざい→課金で解消」という自然な導線
- サブスクをメイン収益源、都度課金は補助

---

## 🔥 現在の開発状況（2025-08-17）

### ✅ 完成済み機能
- 食事記録UI（FoodLogScreen）
- PFC栄養素表示
- ヘルスケア連携（睡眠・運動データ取得）
- AI分析機能（HealthAnalyzer / Gemini API）
- OCR/バーコード読み取り
- 食材検索（SearchSheet）

### ⚠️ 未実装の重要機能
- **AIチャット画面**（原点の核心機能）
- チケット制
- 広告システム
- 即時フィードバック
- クリプトニンジャキャラクター
- 筋トレ記録

---

## 📋 開発フェーズ（小刻み版）

### 🏗️ Phase 0.5：記録効率化の完成（現在ここ）

#### 0.5.1 レシート→在庫システム（実装中）
```swift
// 実装順序
1. PantryItemモデル作成（在庫管理）
2. SearchSheetに[冷蔵庫]タブ追加
3. レシートOCR機能統合
4. 在庫の自動減算ロジック
```

#### 0.5.2 料理バッチ機能
```swift
// 実装順序
1. Batchモデル作成（料理データ）
2. 料理作成画面
3. 小分け消費機能（200g/1000g計算）
4. 栄養素の按分計算
```

---

### 🤖 Phase 1：AIチャット機能（分割版）

#### 1.1 簡易AIチャット（チケット制なし）
```swift
// 実装順序
1. ChatView.swift作成（LINE風UI）
2. メッセージバブルのデザイン
3. Gemini APIとの接続
4. 会話履歴の保存（UserDefaults）
5. 「疲れが抜けない」等への応答テスト
```

**実装時間目安：2-3日**

#### 1.2 チケット制追加
```swift
// 実装順序
1. Ticketモデル作成
2. チケット残高表示UI
3. チケット消費ロジック
4. チケット不足時の警告
5. デバッグ用チケット付与機能
```

**実装時間目安：1-2日**

#### 1.3 広告システム統合
```swift
// 実装順序
1. Google AdMob SDK導入
2. リワード広告の実装
3. 広告視聴→チケット獲得
4. 広告のテスト（テストID使用）
5. 本番広告IDへの切り替え
```

**実装時間目安：2-3日**

#### 1.4 即時フィードバック
```swift
// 実装順序
1. 食事記録後のトリガー実装
2. 栄養バランス分析
3. 次の食事提案ロジック
4. プッシュ通知（オプション）
```

**実装時間目安：1-2日**

---

### 🎨 Phase 2：キャラクター導入

#### 2.1 基本キャラクター実装
```swift
// 実装順序
1. クリプトニンジャ画像素材準備
2. キャラクター吹き出しコンポーネント
3. ホーム画面への配置
4. チャット画面でのアイコン表示
```

#### 2.2 キャラクター演出
```swift
// 実装順序
1. 感情表現（喜び、心配、応援）
2. 時間帯別メッセージ
3. 継続日数による反応変化
4. アニメーション追加
```

---

### 💰 Phase 3：収益モデル完成

#### 3.1 サブスクリプション
```swift
// 実装順序
1. StoreKit 2統合
2. サブスク購入画面
3. 購入状態の管理
4. 週次チケット自動配布
5. 広告非表示処理
```

#### 3.2 都度課金
```swift
// 実装順序
1. チケット追加購入
2. 価格設定（100円/10枚など）
3. 購入フロー実装
4. レシート検証
```

---

## 🛠️ 実装時の注意事項

### 超小刻み開発の徹底
- 1機能 = 10-20行のコード
- 必ず動作確認してから次へ
- エラーが出たら即座に前のステップに戻る

### 各フェーズの完了条件
- **Phase 0.5**：ユーザーが簡単に正確なデータを記録できる
- **Phase 1**：AIと会話ができ、チケット制が機能する
- **Phase 2**：キャラクターが親しみやすく動作する
- **Phase 3**：課金フローが自然に機能する

### テスト優先順位
1. 基本機能の動作確認
2. エラーハンドリング
3. UI/UXの改善
4. パフォーマンス最適化

---

## 📅 スケジュール目安

### 理想的な完成時期
- **Phase 0.5**：1週間（レシート機能含む）
- **Phase 1**：2週間（AIチャット全機能）
- **Phase 2**：1週間（キャラクター）
- **Phase 3**：1週間（収益モデル）

**合計：約5週間でサロン発表可能な状態に**

---

## 🔄 現在の作業状態

### 今すぐやるべきこと
1. **レシート→在庫システムの実装を継続**
2. SearchSheetに冷蔵庫タブを追加
3. PantryItemモデルの作成

### 次のステップ
1. 簡易AIチャット画面の作成（チケット制なし）
2. LINE風UIの実装
3. Gemini APIとの接続テスト

---

## 💡 開発のコツ

### 忘れてはいけない原点
- 「分からない」を解決する
- AIと会話しながら健康改善
- 記録を簡単にする

### 優先順位の判断基準
1. **ユーザー価値**：これがないと使えない機能
2. **技術的依存**：他の機能の前提となる機能
3. **開発効率**：簡単に実装できて効果が大きい機能

---

## 📝 このファイルの使い方

新しいセッション開始時：
1. このファイルを読む
2. 「現在の作業状態」を確認
3. 「今すぐやるべきこと」から着手
4. 完了したら次のステップへ

進捗があったら：
- 「現在の開発状況」を更新
- 完了したフェーズにチェックを入れる
- 新しい課題があれば追記

---

**最終更新**: 2025-08-17  
**次回更新予定**: Phase 0.5完了時